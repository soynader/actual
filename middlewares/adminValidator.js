(function (_0xf1c7c3, _0x539f9b) { const _0x3b51cf = _0x4248, _0x400eb1 = _0xf1c7c3(); while (!![]) { try { const _0x299dbd = -parseInt(_0x3b51cf(0x10c)) / 0x1 * (-parseInt(_0x3b51cf(0x113)) / 0x2) + -parseInt(_0x3b51cf(0x115)) / 0x3 + -parseInt(_0x3b51cf(0x106)) / 0x4 * (parseInt(_0x3b51cf(0x103)) / 0x5) + -parseInt(_0x3b51cf(0x117)) / 0x6 + -parseInt(_0x3b51cf(0x114)) / 0x7 * (-parseInt(_0x3b51cf(0x112)) / 0x8) + parseInt(_0x3b51cf(0x101)) / 0x9 * (-parseInt(_0x3b51cf(0x107)) / 0xa) + parseInt(_0x3b51cf(0x10d)) / 0xb * (parseInt(_0x3b51cf(0x104)) / 0xc); if (_0x299dbd === _0x539f9b) break; else _0x400eb1['push'](_0x400eb1['shift']()); } catch (_0x46600f) { _0x400eb1['push'](_0x400eb1['shift']()); } } }(_0x46fe, 0x4ee19)); import _0x4201f9 from 'jsonwebtoken'; import _0x503030 from '../database/dbpromise.js'; function _0x46fe() { const _0x5f3d94 = ['759275vzpLnl', 'split', 'SELECT\x20*\x20FROM\x20admin\x20WHERE\x20email\x20=\x20?\x20and\x20password\x20=\x20?\x20', 'email', 'Invalid\x20token\x20found', '4666992MLULEQ', '22OWpFTy', '7bRIPdd', '1677270RyNPGL', 'decode', '3192588NBNGri', 'length', 'verify', 'admin', 'json', 'password', '22509FAlFOl', 'No\x20token\x20found', '402185RTuqtS', '264NRMBFt', 'role', '28jTlwwg', '1690WqnOwJ', 'Authorization', 'env', 'server\x20error', 'JWTKEY', '27099SUKZRk']; _0x46fe = function () { return _0x5f3d94; }; return _0x46fe(); } function _0x4248(_0x176491, _0x357d5a) { const _0x46fe14 = _0x46fe(); return _0x4248 = function (_0x424834, _0x408b4c) { _0x424834 = _0x424834 - 0xfe; let _0x178f4e = _0x46fe14[_0x424834]; return _0x178f4e; }, _0x4248(_0x176491, _0x357d5a); } const validateAdmin = async (_0xd001a3, _0x49f530, _0x3aead) => { const _0x178283 = _0x4248; try { const _0x56dd16 = _0xd001a3['get'](_0x178283(0x108)); if (!_0x56dd16) return _0x49f530['json']({ 'msg': _0x178283(0x102), 'token': _0x56dd16, 'logout': !![] }); _0x4201f9[_0x178283(0x119)](_0x56dd16[_0x178283(0x10e)]('\x20')[0x1], process[_0x178283(0x109)][_0x178283(0x10b)], async (_0x3a477a, _0x57f4f2) => { const _0x2d6ed8 = _0x178283; if (_0x3a477a) return _0x49f530[_0x2d6ed8(0xff)]({ 'success': 0x0, 'msg': 'Invalid\x20token\x20found', 'token': _0x56dd16, 'logout': !![] }); else { const _0x2bb0b2 = await _0x503030(_0x2d6ed8(0x10f), [_0x57f4f2[_0x2d6ed8(0x110)], _0x57f4f2[_0x2d6ed8(0x100)]]); if (_0x2bb0b2[_0x2d6ed8(0x118)] < 0x1) return _0x49f530[_0x2d6ed8(0xff)]({ 'success': ![], 'msg': _0x2d6ed8(0x111), 'token': _0x56dd16, 'logout': !![] }); if (_0x2bb0b2[0x0][_0x2d6ed8(0x105)] === _0x2d6ed8(0xfe)) _0xd001a3[_0x2d6ed8(0x116)] = _0x57f4f2, _0x3aead(); else return _0x49f530[_0x2d6ed8(0xff)]({ 'success': 0x0, 'msg': 'Unauthorized\x20token', 'token': _0x56dd16, 'logout': !![] }); } }); } catch (_0x129c7f) { console['log'](_0x129c7f), _0x49f530[_0x178283(0xff)]({ 'msg': _0x178283(0x10a), 'err': _0x129c7f }); } }; export default validateAdmin;